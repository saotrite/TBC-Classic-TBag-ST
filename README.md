This has been mostly copy/pasted from https://www.curseforge.com/wow/addons/tbag-gagstv

One of my favorite addons, but the original developer does not use it anymore

Updating with compatability fixes, but will probably still have issues.